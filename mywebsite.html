<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0" />
<title>Northwoods Playschool ‚Äì Weather & YouTube</title>
<meta name="description" content="Northwoods Playschool ‚Äì Weather intensity, live streams & latest uploads." />

<link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;800&display=swap" rel="stylesheet">
<script src="https://cdn.jsdelivr.net/npm/chart.js"></script>

<style>
:root {
  --primary: #0d1117;
  --secondary: #161b22;
  --accent: #f5c542;
  --green: #1f4d2b;
  --danger: #ff4c4c;
  --brown: #7c2d12;
  --light: #c9d1d9;
}
* { box-sizing:border-box; margin:0; padding:0; font-family:'Inter',sans-serif; }
body { background: var(--primary); color: var(--light); line-height:1.6; transition: background 0.3s, color 0.3s; }
header { text-align:center; padding:3rem 1rem 2rem; }
header img { max-width:250px; width:100%; }
nav { display:flex; justify-content:center; gap:2rem; margin-bottom:2rem; }
nav a { color: var(--light); text-decoration:none; font-weight:600; transition:0.3s; }
nav a:hover { color: var(--accent); }
section { max-width:900px; margin:auto; padding:2rem 1rem; }
h1,h2,h3 { font-weight:800; margin-bottom:1rem; }
h2 { color: var(--accent); }
.card { background: var(--secondary); padding:1.5rem; border-radius:12px; margin-bottom:1.5rem; box-shadow:0 10px 30px rgba(0,0,0,0.4); transition: transform 0.3s, box-shadow 0.3s; }
.card:hover { transform: translateY(-5px); box-shadow:0 15px 35px rgba(0,0,0,0.5); }
.intensity { display:flex; justify-content:space-between; align-items:center; gap:1rem; }
.score { font-size:3rem; font-weight:900; color: var(--accent); transition: all 0.3s; }
.level { font-weight:700; padding:0.4rem 0.75rem; border-radius:999px; background: var(--green); color:#fff; }
#advisory { display:none; padding:1rem; margin-bottom:1rem; border-radius:12px; background: var(--danger); text-align:center; font-weight:700; }
#activeLocation { display:none; padding:0.75rem 1rem; margin-bottom:1rem; border-radius:12px; background:#ffc9c9; color:#7c0000; text-align:center; font-weight:700; }
.funLabel { text-align:center; font-weight:800; font-size:1.1rem; margin-bottom:0.5rem; color: var(--brown); }
.funCard { text-align:center; }
.funScore { font-size:2rem; font-weight:900; color: var(--brown); transition: all 0.3s; }
#alerts, #youtubeChance, #youtubeUploads { margin-top:1rem; padding:1rem; border-radius:12px; background: var(--secondary); }
.youtubeItem { margin-bottom:1rem; }
.youtubeItem a { color: var(--accent); text-decoration:none; font-weight:600; }
.youtubeItem a:hover { text-decoration:underline; }
footer { text-align:center; padding:2rem 1rem; font-size:0.9rem; color: var(--light); margin-top:3rem; }
.fade { opacity:0; transform: translateY(10px); transition: all 0.6s; }
.fade.show { opacity:1; transform: translateY(0); }
#thresholdMsg { margin-top:0.5rem; font-weight:700; color:#ffcc00; }
</style>
</head>
<body>

<header>
  <img src="https://jace200677.github.io/cdnstatic.playweather/northwoods.png" alt="Northwoods Playschool Logo" />
</header>

<nav>
  <a href="#about">About</a>
  <a href="#weather">Weather</a>
  <a href="#youtube">YouTube</a>
  <a href="#contact">Contact</a>
</nav>

<section id="about">
  <h2>About Northwoods Playschool</h2>
  <p>Northwoods Playschool is a warm, nature-inspired learning environment where children grow through exploration, creativity, and play.</p>
</section>

<section id="weather">
  <h2>Weather Safety & Intensity</h2>

  <div id="advisory">‚ö†Ô∏è Severe Weather Active in the United States</div>
  <div id="activeLocation"></div>

  <div class="card intensity fade">
    <div>
      <div class="score" id="score">--</div>
      <div class="level" id="level">Loading‚Ä¶</div>
      <div id="thresholdMsg">Calculating threshold...</div>
      <small>Weather Intensity Score (0‚Äì500)</small>
    </div>
    <div>
      <p id="details" style="opacity:0.75;"></p>
    </div>
  </div>

  <div class="card fade">
    <canvas id="forecastChart" height="150"></canvas>
  </div>

  <div class="funLabel">üí© Poop / Fart Intensity Meter</div>
  <div class="card funCard fade">
    <div class="funScore" id="poopScore">--</div>
    <strong id="poopLevel">Loading‚Ä¶</strong>
    <p style="opacity:0.7;">Poop / Fart Intensity Index (0‚Äì2026) ¬∑ Includes current Weather Score üòÑ</p>
  </div>

  <div id="alerts" class="card fade">
    <h3>National Weather Service Alerts (USA)</h3>
    <ul id="alertsList" style="padding-left:1.2rem;"></ul>
  </div>
</section>

<section id="youtube">
  <h2>Latest YouTube Content</h2>
  <div id="youtubeUploads" class="card fade">Loading channel data‚Ä¶</div>
</section>

<section id="contact">
  <h2>Contact Us</h2>
  <p>Email: <strong>jacefink17@outlook.com</strong></p>
</section>

<footer>
  <small>¬© 2026 Northwoods Playschool ¬∑ Learning through nature üå≤</small>
</footer>

<script>
// ---------------- WEATHER & POOP ----------------
const LAT = 44.9778, LON = -93.2650;
const NWS_POINTS = `https://api.weather.gov/points/${LAT},${LON}`;
const NWS_ALERTS = "https://api.weather.gov/alerts/active?status=actual";
let forecastChart = null;
window.NATIONAL_ALERT_SCORE = 0;

// Local weather intensity calculation
function calculateLocalIntensity(temp, wind, humidity, precip){
  let score=0;
  if(temp>=90||temp<=32) score+=150; else if(temp>=80||temp<=40) score+=75;
  if(wind>=25) score+=125; else if(wind>=15) score+=75;
  if(precip>0) score+=100;
  if(humidity>=90||humidity<=20) score+=50;
  return Math.min(score,500);
}

function calculatePoopIntensity(temp,wind,weatherScore){
  let base=weatherScore*3;
  base+=temp>85?300:0;
  base+=wind>15?200:0;
  base+=Math.random()*400;
  return Math.min(Math.round(base),2026);
}

function poopLevel(score){
  if(score>1600) return "üö® DEFCON GAS";
  if(score>1200) return "üí® Severe Fart Risk";
  if(score>700) return "üò¨ Noticeable";
  if(score>300) return "üôÇ Mild";
  return "üòå All Clear";
}

function getLevel(score){return score>=350?"High":score>=200?"Moderate":"Low";}
function getYouTubeChance(score){return score>=400?"Yes ‚Äì Perfect for streaming!":score>=300?"Probably ‚Äì Good for content.":score>=150?"Maybe ‚Äì Moderate conditions.":"No / Unlikely ‚Äì Avoid outdoor content.";}

async function fetchLocalWeather(){
  try{
    const p=await fetch(NWS_POINTS).then(r=>r.json());
    const stations=await fetch(p.properties.observationStations).then(r=>r.json());
    const id=stations.features[0].properties.stationIdentifier;
    const obs=await fetch(`https://api.weather.gov/stations/${id}/observations/latest`).then(r=>r.json());
    const d=obs.properties;
    return {temp:d.temperature.value*9/5+32,wind:d.windSpeed.value*2.23694,humidity:d.relativeHumidity.value,precip:(d.precipitationLastHour.value||0)*0.03937};
  }catch{return {temp:70,wind:0,humidity:50,precip:0};}
}

function getAlertSeverityScore(alert){
  const e=alert.properties.event.toLowerCase();
  if(e.includes("tornado")||e.includes("hurricane")) return 500;
  if(e.includes("blizzard")||e.includes("ice storm")) return 400;
  if(e.includes("severe thunderstorm")) return 300;
  if(e.includes("flood")||e.includes("high wind")) return 200;
  if(e.includes("advisory")) return 100;
  return 0;
}

// NWS alerts
async function updateNWSAlerts(){
  try{
    const data=await fetch(NWS_ALERTS).then(r=>r.json());
    const list=document.getElementById("alertsList");
    const locationBox=document.getElementById("activeLocation");
    list.innerHTML="";
    locationBox.style.display="none";
    let maxScore=0,focusAlert=null;
    if(data.features.length){
      data.features.forEach(a=>{
        const score=getAlertSeverityScore(a);
        if(score>maxScore){maxScore=score;focusAlert=a;}
        const li=document.createElement("li");
        li.textContent=`${a.properties.event}: ${a.properties.areaDesc}`;
        list.appendChild(li);
      });
    } else list.innerHTML="<li>No active alerts in the USA.</li>";
    window.NATIONAL_ALERT_SCORE=maxScore;
    if(focusAlert && maxScore>=200){
      locationBox.style.display="block";
      locationBox.textContent=`Severe Weather Focus: ${focusAlert.properties.event} ‚Äî ${focusAlert.properties.areaDesc}`;
    }
  }catch{window.NATIONAL_ALERT_SCORE=0;}
}

// Dynamic threshold based on forecast
function getDynamicThreshold(currentScore){
  const base=300+Math.random()*150; // 300‚Äì450
  const modifier=currentScore/2;
  return Math.min(Math.round(base+modifier),500);
}

// Forecast projections (synthetic demo)
async function fetchForecastProjections(){
  const projections=[];
  for(let i=1;i<=6;i++){
    const temp=50+Math.random()*40;
    const wind=Math.random()*25;
    const humidity=30+Math.random()*70;
    const precip=Math.random()>0.7?Math.random()*2:0;
    const score=calculateLocalIntensity(temp,wind,humidity,precip);
    projections.push({hour:i*3,score});
  }
  return projections;
}

function updateForecastChart(projections){
  const labels=projections.map(p=>`${p.hour}h`);
  const data=projections.map(p=>p.score);
  const ctx=document.getElementById('forecastChart').getContext('2d');
  if(forecastChart) forecastChart.destroy();
  forecastChart=new Chart(ctx,{
    type:'line',
    data:{
      labels:labels,
      datasets:[{
        label:'Projected Weather Score',
        data:data,
        borderColor:'#f5c542',
        backgroundColor:'rgba(245,197,66,0.2)',
        tension:0.4,
        fill:true
      }]
    },
    options:{
      responsive:true,
      scales:{y:{beginAtZero:true,max:500}},
      plugins:{legend:{display:true,labels:{color:'#c9d1d9'}}},
    }
  });
}

// Update weather UI
async function updateWeather(){
  const obs=await fetchLocalWeather();
  const local=calculateLocalIntensity(obs.temp,obs.wind,obs.humidity,obs.precip);
  const score=Math.max(local,window.NATIONAL_ALERT_SCORE);
  const threshold=getDynamicThreshold(score);

  document.getElementById("score").textContent=score;
  document.getElementById("level").textContent=getLevel(score);
  document.getElementById("details").textContent=`Local: ${obs.temp.toFixed(1)}¬∞F ¬∑ Wind ${obs.wind.toFixed(1)} mph ¬∑ Humidity ${obs.humidity}%`;

  const thresholdMsg=document.getElementById("thresholdMsg");
  thresholdMsg.textContent=score>threshold?"‚ö†Ô∏è Threshold Exceeded!":"Within Safe Range";

  document.getElementById("youtubeChance").textContent="Video / Live Stream Chance: "+getYouTubeChance(score);

  const poop=calculatePoopIntensity(obs.temp,obs.wind,score);
  document.getElementById("poopScore").textContent=poop;
  document.getElementById("poopLevel").textContent=poopLevel(poop);

  const projections=await fetchForecastProjections();
  updateForecastChart(projections);

  document.querySelectorAll('.fade').forEach(el=>el.classList.add('show'));
}

// ---------------- INIT ----------------
updateNWSAlerts();
updateWeather();
setInterval(()=>{updateNWSAlerts(); updateWeather();},300000);
setTimeout(()=>location.reload(),120000);

// ---------------- YOUTUBE LATEST UPLOADS ----------------
async function fetchYouTubeRSS(){
  try{
    const channelId="Jaceschannel-hy6rl";
    const url=`https://www.youtube.com/feeds/videos.xml?channel_id=${channelId}`;
    const res=await fetch(url);
    const text=await res.text();
    const parser=new DOMParser();
    const xml=parser.parseFromString(text,"text/xml");
    const items=xml.querySelectorAll("entry");
    const container=document.getElementById("youtubeUploads");
    container.innerHTML="";
    items.forEach((item,i)=>{
      if(i>=5) return; // show latest 5 uploads
      const title=item.querySelector("title").textContent;
      const link=item.querySelector("link").getAttribute("href");
      const div=document.createElement("div");
      div.className="youtubeItem";
      div.innerHTML=`<a href="${link}" target="_blank">${title}</a>`;
      container.appendChild(div);
    });
  }catch{
    document.getElementById("youtubeUploads").textContent="Failed to load channel data.";
  }
}

fetchYouTubeRSS();
</script>
</body>
</html>
